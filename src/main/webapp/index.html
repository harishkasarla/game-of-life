<html ng-app="main">
    <head>
        <script src="https://code.jquery.com/jquery-2.2.4.min.js"   integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="   crossorigin="anonymous"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.5/angular.min.js"></script>
        <style>
            .alive {
                background-color: blue;
            }
            .dead {
                background-color: red;
            }

            .citizen {
                width: 10px;
                height: 10px;
            }
        </style>
    </head>
    <body ng-controller="MainCtrl">
        <div>
            <label>From:</label>
            <input ng-model="startWith" type="number">
            <label>To:</label>
            <input ng-model="endWith" type="number">
        </div>
        <div>
            <input ng-model="points">
        </div>
        <div>
            <button ng-click="start()" ng-disable="started">Start!</button>
            <button ng-click="stop()" ng-disable="!started">Stop!</button>
        </div>
        <table>
            <tr ng-repeat="row in rows">
                <td ng-repeat="column in row">
                    <div class="citizen" ng-class="{alive: column.alive, dead: !column.alive}"></div>
                </td>
            </tr>
        </table>
        <script>
            (function(){
                angular.module('main', []).controller('MainCtrl', function($scope, $interval, $http){
                    var timer;
                    $scope.startWith = 40;
                    $scope.endWith = 40;
                    $scope.points = '3,4-4,5-5,3-5,4-5,5';
                    $scope.started = false;
                    $scope.start = function(){
                        var initialPoints = $scope.points.split('-').map(function(it){
                            var point = it.split(',');
                            return {x:point[0], y:point[1] }
                        });
                        var config = {x:$scope.startWith, y:$scope.endWith};
                        var data = {initialPoints:initialPoints, config:config};
                        $http.post('http://localhost:9000/v1/games', data);
                        $scope.started = true;
                        $interval(function(){
                            timer = $http.get('http://localhost:9000/v1/games').then(function(res){
                                $scope.rows = res.data.rows;
                            });
                        }, 100);
                    }
                });
            })();

        </script>
    </body>
</html>
